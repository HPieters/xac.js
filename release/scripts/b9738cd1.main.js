!function(a){"use strict";var b=a.App=Ember.Application.create({LOG_TRANSITIONS:!0});b.Router.map(function(){this.route("dashboard",{path:"/"}),this.resource("servers",{path:"/servers"},function(){this.route("new"),this.resource("view",{path:"/:server_id"},function(){this.route("delete",{path:"/delete"}),this.route("edit",{path:"/edit"})})}),this.route("notifications",{path:"/notifications"}),this.route("settings",{path:"/settings"}),this.resource("overview",{path:"/overview/"},function(){this.route("view",{path:"/:pools_id"}),this.resource("server",{path:"/server"},function(){this.resource("vm",{path:"/vm"},function(){this.route("new")})})})}),b.OverviewPoolsRoute=Ember.Route.extend({activate:function(){$(document).attr("title","XAC - Overview - Pool")}}),b.ready=function(){Ember.debug("Ready run")}}(this),App.Store=DS.Store.extend({revision:13,adapter:DS.LSAdapter.create({namespace:"xac.js"})}),App.Server=DS.Model.extend({hostUrl:DS.attr("string"),hostName:DS.attr("string"),hostPassword:DS.attr("string"),versionMayor:DS.attr("number"),versionMinor:DS.attr("number"),pool:DS.belongsTo("App.Pools")}),App.Global=Ember.Object.extend({number:null,notifications:0,version:"0.0.2.9-alpha",pools:null}),App.Global=App.Global.create({number:0,pools:0}),App.Pools=DS.Model.extend({poolName:DS.attr("string"),servers:DS.hasMany("App.Server"),serverCount:function(){var a=this.get("servers");return a.get("length")}.property("servers.@each")}),App.DashboardRoute=Ember.Route.extend({activate:function(){$(document).attr("title","XAC - Dashboard")},setupController:function(a){a.set("buildVersion",App.Global.get("version"))}}),App.NotificationsRoute=Ember.Route.extend({activate:function(){$(document).attr("title","XAC - Notifications")}}),App.ServersRoute=Ember.Route.extend({activate:function(){$(document).attr("title","XAC - Servers")},model:function(){return App.Server.find()}}),App.ServersIndexRoute=Ember.Route.extend({redirect:function(){var a=this.modelFor("servers").get("firstObject");this.transitionTo("view.index",a)}}),App.ViewIndexRoute=Ember.Route.extend({model:function(a){return App.Server.find(a.server_id)}}),App.NewRoute=Ember.Route.extend({setupController:function(){this.controllerFor("servers.new").setProperties({isNew:!0})}}),App.ViewEditRoute=Ember.Route.extend({model:function(a){return console.log(console.log(this.server_id)),App.Server.find(a.server_id)},renderTemplate:function(){this.controllerFor("servers.new").update(),this.render("view/new")},setupController:function(a,b){this.controllerFor("servers.new").setProperties({isNew:!1,content:b})}}),App.ViewDeleteRoute=Ember.Route.extend({model:function(a){return App.Server.find(a.server_id)}}),App.SettingsRoute=Ember.Route.extend({activate:function(){$(document).attr("title","XAC - Settings")}}),App.ApplicationRoute=Ember.Route.extend({renderTemplate:function(){this.render(),this.render("menu",{outlet:"menu",into:"application",controller:"menu"}),this.render("footer",{outlet:"footer",into:"application"})},setupController:function(a){a.set("buildVersion",App.Global.get("version"))}}),App.OverviewRoute=Ember.Route.extend({activate:function(){$(document).attr("title","XAC - Overview")},model:function(){return App.Pools.find()}}),App.OverviewIndexRoute=Ember.Route.extend({redirect:function(){var a=this.modelFor("overview").get("firstObject");this.transitionTo("overview.view",a)}}),App.OverviewViewRoute=Ember.Route.extend({model:function(a){return App.Pools.find(a.pools_id)}}),App.ApplicationController=Ember.Controller.extend({init:function(){App.Pools.find(),App.Pools.find({}).then(function(){var a=App.Pools.all().content.length;App.Global.set("pools",a)}),App.Server.find(),App.Server.find({}).then(function(){var a=App.Server.all().content.length;App.Global.set("number",a)})}}),App.MenuController=Ember.Object.extend({serverCount:function(){return App.Global.number}.property("App.Global.number"),notifications:function(){return App.Global.notifications}.property("App.Global.notifications")}),App.ServersIndexController=Ember.ArrayController.extend({deleteServer:function(a){a.deleteRecord(),App.Global.set("number",App.Global.get("number")-1),a.save()}}),App.ServersNewController=Ember.Controller.extend(Ember.Evented,{isNew:!0,authFailed:!1,update:function(){this.isNew?(this.set("hostUrl",""),this.set("hostName",""),this.set("hostPassword","")):(this.set("hostUrl",this.content.get("hostUrl")),this.set("hostName",this.content.get("hostName")),this.set("hostPassword",this.content.get("hostPassword")))}.observes("isNew"),serverExists:function(){console.log("change")}.observes("authFailed"),createServer:function(){var a=this.get("hostUrl"),b=this.get("hostName"),c=this.get("hostPassword");if($.trim(a)&&$.trim(b)&&$.trim(c)){if(this.isNew){$(".createServerInput input").attr("disabled","disabled");var d=this,e=$(".createServerInput input"),f=new XenAPI(b,c,a);return f.init(function(g){g?e.removeAttr("disabled"):($("#add-server").val("Loading..."),f.serverVersion(function(f,g){if(f)d.set("authFailed",!0),e.removeAttr("disabled"),$("#add-server").val("Add Server");else{var h=App.Server.createRecord({hostUrl:a,hostName:b,hostPassword:c,versionMayor:g.mayor,versionMinor:g.minor}),i=App.Pools.createRecord({poolName:"Demo"});i.set("servers",h),h.set("pool",i),App.Global.set("number",App.Global.get("number")+1),App.Global.set("notifications",App.Global.get("notifications")+1),h.store.commit(),i.store.commit(),d.set("hostUrl",""),d.set("hostName",""),d.set("hostPassword",""),h.one("didCreate",this,function(){e.removeAttr("disabled"),d.transitionToRoute("servers.index"),$("#add-server").val("Add Server")})}}))})}var g=this.get("model");g.set("hostUrl",a),g.set("hostPassword",c),g.set("hostName",b),this.get("store").commit(),g.one("didUpdate",this,function(){this.transitionToRoute("servers.index")}),this.set("hostUrl",""),this.set("hostName",""),this.set("hostPassword","")}}}),App.OverviewController=Ember.ArrayController.extend({}),App.DashboardController=Ember.Object.extend({servers:function(){return App.Global.number}.property("App.Global.number"),pools:function(){return App.Global.pools}.property("App.Global.pools")}),App.NotificationsView=Ember.View.extend({didInsertElement:function(){App.Global.set("notifications",0)}}),App.Focusable=Ember.Mixin.create({focused:!1,focusIn:function(){return this.set("focused",!0)},focusOut:function(){return this.set("focused",!1)}}),App.AsyncValidation=Ember.Mixin.create({valid:function(){var a,b=this;return this.get("focused")?(this.set("code",""),this.set("message","")):(a=this.get("value"),this.validate(a,function(c,d){return a!==b.get("value")||b.get("focused")?void 0:(b.set("code",c),b.set("message",d))}))}.observes("focused"),validate:function(a,b){return b("","")}}),App.TextField=Ember.View.extend(App.Focusable,App.AsyncValidation,{classNames:["control-group"],type:"text",value:"",placeholder:"",code:"",classNameBindings:["code"],message:"",template:Ember.Handlebars.compile('<div class="controls" >\n{{view Ember.TextField\nplaceholderBinding = "view.placeholder"\nvalueBinding = "view.value"\ntypeBinding = "view.type"\n  }}\n <span class="help-inline">{{view.message}}</span>\n</div>')}),App.ValidateTextField=App.TextField.extend({validate:function(a,b){return 0===a.length?b("error","Please enter a value."):b("success","Ok.")}}),App.HostUrlField=App.TextField.extend({placeholder:"IP Address",validate:function(a,b){if(0===a.length)return b("error","Please enter a valid url");b("loading","One moment while we check the adress."),console.log(a);var c=new XenAPI("","",a);return c.init(function(a){a?b("error","Host could not be found"):b("success","Found XENAPI instance!")})}}),App.LinkView=Ember.View.extend({tagName:"li",classNameBindings:["active"],active:Ember.computed(function(){var a=this.get("router"),b=this.get("route"),c=this.get("content"),d=[b];return c&&d.push(c),a.isActive.apply(a,d)}).property("router.url"),router:Ember.computed(function(){return this.get("controller").container.lookup("router:main")}),click:function(){var a=this.get("router"),b=this.get("route"),c=this.get("content");params=[b],c&&params.push(c),a.transitionTo.apply(a,params)}});